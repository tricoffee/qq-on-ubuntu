(defun w3m-link-numbering (&rest args)
  "Make overlays that display link numbers."
  (when w3m-link-numbering-mode
	(save-excursion
	  (goto-char (point-min))
	  (let ((i 0)
			overlay num)
		(catch 'already-numbered
		  (while (w3m-goto-next-anchor)
			(when (get-char-property (point) 'w3m-link-numbering-overlay)
			  (throw 'already-numbered nil))
			(setq overlay (make-overlay (point) (1+ (point)))
				  num (format "[%d]" (incf i)))
			(w3m-static-if (featurep 'xemacs)
				(progn
				  (overlay-put overlay 'before-string num)
				  (set-glyph-face (extent-begin-glyph overlay)
								  'w3m-link-numbering))
			  (w3m-add-face-property 0 (length num) 'w3m-link-numbering num)
			  (overlay-put overlay 'before-string num)
			  (overlay-put overlay 'evaporate t))
			(overlay-put overlay 'w3m-link-numbering-overlay i)))))))
